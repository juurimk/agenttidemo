{{ $data := index site.Data site.Language.Lang }}

{{/* Choose sectionset: prefer explicit 'demoshow', fallback to 'fullshow2', else lightset */}}
{{ $sectionset := or (index site.Params.sectionsets "demoshow") (index site.Params.sectionsets "fullshow2") }}
{{ if not $sectionset }}{{ $sectionset = "lightset" }}{{ end }}

{{ if $data.demoshow.demoshow.enable }}
{{ with $data.demoshow.demoshow }}

{{/* Background handling copied from fullshow2 */}}
{{ $bgType := "" }}
{{ $bgClass := "" }}
{{ $bgStyle := "" }}

{{ if .background }}
  {{ $bgType = .background.type }}
{{ else }}
  {{ $bgType = "color" }}
{{ end }}

{{ if eq $bgType "image" }}
  {{ $bgClass = "bg-image" }}
  {{ if .background.image }}
    {{ $imageUrl := .background.image | absURL }}
    {{ $bgStyle = printf "--bg-image: url('%s');" $imageUrl }}
  {{ end }}
{{ else if eq $bgType "svg" }}
  {{ $bgClass = "bg-svg" }}
  {{ if .background.svg.pattern }}
    {{ $svgUrl := .background.svg.pattern | absURL }}
    {{ $svgOpacity := .background.svg.opacity | default 0.3 }}
    {{ $svgRepeat := .background.svg.repeat | default "no-repeat" }}
    {{ $svgSize := .background.svg.size | default "cover" }}
    {{ $svgPosition := .background.svg.position | default "center" }}
    {{ $svgAttachment := .background.svg.attachment | default "scroll" }}
    {{ $bgStyle = printf "--svg-pattern: url('%s'); --svg-opacity: %v; --svg-repeat: %s; --svg-size: %s; --svg-position: %s; --svg-attachment: %s;" $svgUrl $svgOpacity $svgRepeat $svgSize $svgPosition $svgAttachment }}
  {{ end }}
{{ else if eq $bgType "color" }}
  {{ $bgClass = "bg-color" }}
{{ end }}

<section id="demoshow" class="section fullshow2-section section-{{ $sectionset }} {{ $bgClass }}" {{ if $bgStyle }}style="{{ $bgStyle | safeCSS }}"{{ end }}>
  <div class="fullshow2-overlay"></div>
  <div class="container">
    <div class="row align-items-center">
      <div class="col-12 text-center">
        <div class="fullshow2-content text-center">
          {{ if .title }}<h2>{{ .title }}</h2>{{ end }}
          {{ if .description }}<p>{{ .description }}</p>{{ end }}
        </div>
      </div>
    </div>

    {{ if .items }}
    <div class="row services-grid mt-4" role="list" style="margin-top: 120px;">
      {{ range .items }}
      <div class="col-lg-4 col-md-6 col-sm-6 col-12 mb-4" role="listitem">
        <article class="service-card h-100" tabindex="0" aria-label="{{ .name }}" {{ if .link }}onclick="window.location.href='{{ .link | default "#" }}'" style="cursor: pointer;"{{ end }}>
          <div class="service-card-inner">
            <div class="service-image-area">
              <img class="service-image lozad" 
                   data-src="{{ .image_webp | absURL }}" 
                   onerror="this.onerror=null;this.src='{{ .image | absURL }}'" 
                   alt="{{ .name }}"
                   style="width: 100%; height: 100%; object-fit: cover;">
            </div>
            <div class="service-overlay">
              <div class="service-content">
                <div class="service-text-area">
                  <h3 class="service-title">{{ .name }}</h3>
                  {{ if .short_description }}
                  <div class="service-short-description"><p>{{ .short_description }}</p></div>
                  {{ end }}
                  {{ if .link }}
                  <div class="service-cta">
                    <a href="{{ .link }}" class="btn btn-calendar-fill" aria-label="Siirry demoon {{ .name }}">Siirry demoon</a>
                  </div>
                  {{ end }}
                </div>
              </div>
            </div>
          </div>
        </article>
      </div>
      {{ end }}
    </div>
    {{ end }}

  </div>
</section>
{{ end }}
{{ end }}
